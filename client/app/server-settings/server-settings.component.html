<div class="container">
  <div class="card card-main">
    <div class="card-header">
      Server Settings
    </div>
  </div>

  <div class="card card-main">
    <div class="card-header container-vertical-padding">
      <div class="flex-container flex-align-items-center flex-stretch">
        <span>OmniTrack Client Apps</span>
        <button mat-raised-button color="primary" (click)="onUploadClicked()">Upload</button>
      </div>
    </div>
    <mat-tab-group *ngIf="binaryGroupList && binaryGroupList.length > 0" class="tab-group" (selectedTabChange)="onTabChanged($event)">
      <mat-tab *ngFor="let binaryGroup of binaryGroupList" [label]="binaryGroup._id">
        <table class="table table-data">
          <thead>
            <tr class="singleline">
              <th>App Version</th>
              <th>Minimum OS</th>
              <th>File Size</th>
              <th>Uploaded</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr class="singleline hoverable" *ngFor="let binary of binaryGroup.binaries">
              <td>{{binary.version}}</td>
              <td>{{binary.minimumOsVersionReadable}}</td>
              <td>{{binary.fileSize | fileSize}}</td>
              <td>{{binary.createdAt | date: 'short'}}</td>
              <td class="button-cell">
                <div class="text-right">
                  <a [href]="'/api/clients/download?platform=' + binary.platform + '&version=' + binary.version" mat-icon-button>
                    <mat-icon class="material-icons">file_download</mat-icon>
                  </a>
                  <button mat-icon-button (click)="onRemoveBinaryClicked(binary._id)">
                    <mat-icon class="material-icons">delete</mat-icon>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </mat-tab>
    </mat-tab-group>
    <div class="card-footer small" *ngIf="isEmpty()===true">
      No app files are assigned in the server.
    </div>
  </div>

  <div class="card card-main">
    <div class="card-header">
      Researchers
    </div>
    <table class="table table-data">
      <thead>
        <tr class="singleline">
          <th>Email</th>
          <th>Alias</th>
          <th>Registered</th>
          <th>Status</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr class="singleline" *ngFor="let researcher of researchers">
          <td>{{researcher.email}}</td>
          <td>{{researcher.alias}}</td>
          <td>{{researcher.createdAt | date: 'short'}}</td>
          <td *ngIf="researcher._id !== myId" [ngSwitch]="researcher.account_approved">
              <span *ngSwitchCase="true">
                Approved
              </span>
              <span *ngSwitchCase="undefined">
                Approval Pending
                </span>
              <span *ngSwitchCase="false">
                Declined
              </span>
          </td>
          <td  *ngIf="researcher._id !== myId" class="button-cell right-padding text-right">
            <button class="btn btn-primary btn-sm" *ngIf="researcher.account_approved !== true" (click)="onSetResearcherApprovedStatus(researcher._id, true)">Approve</button>
            <button class="btn btn-danger btn-sm"  *ngIf="researcher.account_approved !== false" (click)="onSetResearcherApprovedStatus(researcher._id, false)">Decline</button>
            
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
