<div class="header">
  <div class="content">
    <div class="logo_container">
      <img class="logo" src="/assets/omnitrack_research_kit_logo.svg">
    </div>
    <div class="heading_container" *ngIf="!isLoadingSelectedExperiment">
      <div class="dropdown experiment" *ngIf="api.getSelectedExperimentId()">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
          aria-expanded="false">
          {{selectedExperimentName}}
        </button>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          <h6 class="dropdown-header text-color-accented" *ngIf="myExperimentInfos.length > 0">Your experiments</h6>
          <a class="dropdown-item small dropdown-item-experiment" (click)="onExperimentSelected(exp._id)" *ngFor="let exp of myExperimentInfos">{{exp.name}}</a>
          <h6 class="dropdown-header text-color-accented" *ngIf="guestExperimentInfos.length > 0">Guest experiments</h6>
          <a class="dropdown-item small dropdown-item-experiment" (click)="onExperimentSelected(exp._id)" *ngFor="let exp of guestExperimentInfos">{{exp.name}}</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item small dropdown-item-experiment" disabled = true>Experiment List</a>
          
        </div>
      </div>

      <span class="tag tag-primary tag-researcher-role flex-align-self-center left-margin-1em flex-container flex-align-items-center" [ngClass]="(getMyRole() | async)"
      matTooltip="Your role in this experiment." matTooltipPosition="below">
        <span>{{getMyRole() | async}}</span>
        <mat-icon class="material-icons left-margin-dot2em text-size-1dot2em">help_outline</mat-icon></span>
      <!--<button type="button" class="btn btn-info btn-sm" i="plus">Add New Experiment</button>-->
    </div>
    <div class="profile_container">
      <div class="sign_in" *ngIf="(authService.currentResearcher | async).signedIn != true">
        <button class="btn btn-primary" (click)="goToSignIn()">Sign In</button>
      </div>
      <div class="signed_in_profile" *ngIf="(authService.currentResearcher | async).signedIn == true">
        <div class="information">
          <div class="name font-weight-bold">
            {{(authService.currentResearcher | async).alias}}
          </div>
          <div class="email font-weight-light">
            {{(authService.currentResearcher | async).email}}
          </div>
        </div>
        <button class="btn btn-secondary btn-sm" (click)="onSignOutClicked()">Sign Out</button>
      </div>
    </div>
    <!--<div class="header-border"></div>-->
  </div>
</div>
<div id="main-overlay-container" class="overlay-busy" *ngIf="isLoadingSelectedExperiment">
  <app-busy-overlay class="main-busy" [scale]="0.75"></app-busy-overlay>
</div>
<div id="research_dashboard_wrapper" *ngIf="!isLoadingSelectedExperiment">
  <div id="research_column_sidebar">
    <div class="nav nav-pills flex-column">
      <div class="group" *ngFor="let group of dashboardNavigationGroups">
        <div class="small nav-link nav-subtitle">{{group.name}}</div>
        <a class="nav-link flex-container flex-align-items-center" [class.disabled] = "menu.disabled===true" *ngFor="let menu of group.menus" [routerLink]="['/research/dashboard', api.getSelectedExperimentId(), menu.key]"
          [routerLinkActive]="['active']">
          <mat-icon *ngIf="menu.icon" class="gnb-icon material-icons">{{menu.icon}}</mat-icon>
          <!--<img class="gnb-icon material-icons" *ngIf="menu.iconPath" [src]="menu.iconPath">
            <mat-icon *ngIf="menu.svgIcon" class="gnb-icon material-icons" [svgIcon]="menu.svgIcon"></mat-icon>-->

          <span>{{menu.name}}</span>
        </a>
      </div>
    </div>
  </div>
  <div id="research_column_main">
    <div class="title-header-container">
      <div class="card" class="title-header" [ngClass]="upperHeaderTitle!=undefined? 'with-button':''" *ngIf="headerTitle">
        <div *ngIf="!upperHeaderTitle" class="dashboard-title">{{headerTitle}}</div>
        <div *ngIf="upperHeaderTitle" class="flex-container flex-align-items-center">
          <button mat-icon-button class="margin-right-small text-color-white" [routerLink]="backNavigationUrl">
            <mat-icon class="material-icons">arrow_back</mat-icon>
          </button>
          <div class="flex-child">
            <small class="dashboard-back-title">{{upperHeaderTitle}}</small>
            <div class="dashboard-title">{{headerTitle}}</div>
          </div>
        </div>
      </div>
      <mat-progress-bar [@ySlide]="(notificationService.globalBusyFlag | async)" id="main-progress-bar" mode="indeterminate" color="accent"></mat-progress-bar>
    </div>
    <div class="container-fluid">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>
